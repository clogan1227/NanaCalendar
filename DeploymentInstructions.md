# Deployment Guide: Nana Calendar on Raspberry Pi

### Overview
This guide covers the steps to set up a Raspberry Pi to run a pre-built React application in a full-screen "kiosk mode." The application will be served locally on the Pi and will launch automatically on boot.

### Prerequisites
*   A `build` folder generated by running `npm run build` on your main development computer.
*   A Raspberry Pi set up with Raspberry Pi OS and connected to your local network.
*   The ability to connect to your Raspberry Pi's terminal (via SSH or with a direct keyboard/monitor).
*   Your Raspberry Pi's IP address (find this by running `hostname -I` on the Pi's terminal).

---

### **Step 1: Prepare the Raspberry Pi (One-Time Setup)**

These commands are run in the terminal **on your Raspberry Pi**.

#### **1.1: Update and Install Essential Software**
This ensures your Pi has an up-to-date browser, Node.js for running our server, and a tool to hide the mouse cursor.

```bash
sudo apt update
sudo apt install -y nodejs npm chromium-browser unclutter
```

#### **1.2: Install Global Node.js Packages**
We'll install `serve` (a simple web server) and `pm2` (a powerful process manager that will keep your app running and restart it on boot).

```bash
sudo npm install -g serve pm2
```

---

### **Step 2: Deploy and Automate the Application**

#### **2.1: Transfer Your Application to the Pi**
This command is run **on your main computer's terminal**. It securely copies your `build` folder to the Pi's home directory.

1.  Replace `<PI_IP_ADDRESS>` with your Raspberry Pi's actual IP address.
2.  Run the command:
    ```bash
    scp -r build/ pi@<PI_IP_ADDRESS>:~/
    ```

#### **2.2: Create the Kiosk Launch Script**
This script will run on the Pi to launch the browser in full-screen mode.

1.  In the **Raspberry Pi's terminal**, create and open a new script file:
    ```bash
    nano launch-kiosk.sh
    ```
2.  Copy and paste the following content into the editor:
    ```bash
    #!/bin/bash

    # Hide the mouse cursor after 1 second of inactivity
    unclutter -idle 1 -root &

    # Prevent the "restore session" popup on Chromium after a reboot
    sed -i 's/"exited_cleanly":false/"exited_cleanly":true/' ~/.config/chromium/Default/Preferences
    sed -i 's/"exit_type":"Crashed"/"exit_type":"Normal"/' ~/.config/chromium/Default/Preferences

    # Launch Chromium in kiosk mode, pointing to our local server
    /usr/bin/chromium-browser --noerrdialogs --disable-infobars --kiosk http://localhost:3000
    ```
3.  Save and exit the editor by pressing `Ctrl+X`, then `Y`, then `Enter`.
4.  Make the script executable:
    ```bash
    chmod +x launch-kiosk.sh
    ```

#### **2.3: Start Your Application with `pm2`**
Now we'll tell the `pm2` process manager to run your server and kiosk script.

1.  **Start the web server:**
    ```bash
    pm2 start serve -s build --name "calendar-server"
    ```
2.  **Start the kiosk browser:**
    ```bash
    pm2 start ./launch-kiosk.sh --name "calendar-kiosk"
    ```
    At this point, your calendar application should appear full-screen on the monitor connected to your Pi.

#### **2.4: Automate on Boot**
This final step makes the setup permanent, so it runs automatically every time the Pi is powered on.

1.  Tell `pm2` to generate a startup script:
    ```bash
    pm2 startup
    ```
2.  > **Important:** The command above will output another command that you must **copy and run exactly as it appears**. It will start with `sudo env...`.
3.  After running the command it gives you, save the current process list so `pm2` knows what to start on boot:
    ```bash
    pm2 save
    ```

### **Deployment Complete**
Your setup is finished. You can now reboot your Raspberry Pi (`sudo reboot`), and it will automatically launch your Nana Calendar.
